{% extends '_base.html' %}
{% load static %}

{% load crispy_forms_tags %}

{% block content %}
  <h1>New Character</h1>
  <form method="post">
    {% csrf_token %}
    {{ form|crispy }}
    <button type="button" class="btn btn-danger ml-2" id="randomize-stats">Randomize Stats</button>
    <button type="submit" class="btn btn-success ml-2">Create Character</button>
   
  </form>
  <br />  
{% endblock %}

{% block javascript %}
  <script>
    document.addEventListener('DOMContentLoaded', function () {
      const randomizeButton = document.getElementById('randomize-stats')
      randomizeButton.addEventListener('click', function () {
        // Call the backend view to generate random stats
        fetch('/character/generate_random_stats/')
          .then((response) => response.json())
          .then((data) => {
            // Update the form fields with the random stats
            document.getElementById('id_strength').value = data.strength
            document.getElementById('id_dexterity').value = data.dexterity
            document.getElementById('id_constitution').value = data.constitution
            document.getElementById('id_intelligence').value = data.intelligence
            document.getElementById('id_wisdom').value = data.wisdom
            document.getElementById('id_charisma').value = data.charisma
          })
      })
    })
  </script>
{% endblock %}
