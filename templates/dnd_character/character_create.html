{% extends '_base.html' %}
{% load static %}

{% block css %}
  <link rel="stylesheet" href="https://pyscript.net/latest/pyscript.css" />
  <script defer src="https://pyscript.net/latest/pyscript.js"></script>

  <link rel="stylesheet" href="{% static 'css/bootstrap.min.css' %}" />
  <link rel="stylesheet" href="{% static 'css/base.css' %}" />
{% endblock %}

{% load crispy_forms_tags %}

{% block content %}
  <h1>New Character</h1>
  <form method="post">
    {% csrf_token %}
    {{ form|crispy }}
    <button type="button" id="randomize-stats">Randomize Stats</button>
    <button type="submit">Create Character</button>
  </form>
{% endblock %}

{% block javascript %}
  <script>
    document.addEventListener('DOMContentLoaded', function () {
      const randomizeButton = document.getElementById('randomize-stats')
      randomizeButton.addEventListener('click', function () {
        // Call the backend view to generate random stats
        fetch('/character/generate_random_stats/')
          .then((response) => response.json())
          .then((data) => {
            // Update the form fields with the random stats
            document.getElementById('id_strength').value = data.strength
            document.getElementById('id_dexterity').value = data.dexterity
            document.getElementById('id_constitution').value = data.constitution
            document.getElementById('id_intelligence').value = data.intelligence
            document.getElementById('id_wisdom').value = data.wisdom
            document.getElementById('id_charisma').value = data.charisma
          })
      })
    })
  </script>
{% endblock %}
